<template name="transactions">

    <div class="ui huge breadcrumb">
        <a class="section" href="{{pathFor 'transactions'}}">Transactions</a>
        {{#if year}}
            <i class="right chevron icon divider"></i>
            <a class="section" href="{{pathFor 'transactionsByYear' year=year}}">{{year}}</a>
            {{#if month}}
            <i class="right chevron icon divider"></i>
            <a class="section">{{monthName month}}</a>
            {{/if}}
        {{/if}}
    </div>

    {{#unless year}}
        {{> yearLinks}}
    {{ else }}
        {{#unless month}}
            {{> monthLinks}}
        {{/unless}}
    {{/unless}}

    <div class="ui small statistics">
        <div class="statistic">
            <div class="value">{{nrOfTransactions}}</div>
            <div class="label">Transactions</div>
        </div>
        <div class="statistic">
            <div class="value">{{nrOfUncategorizedTransactions}}</div>
            <div class="label">Uncategorized</div>
        </div>
    </div>

    <table class="ui unstackable striped celled table">
        <thead>
            <tr>
                <th>Date</th>
                <th class="right aligned">Amount</th>
                <th>Description</th>
                <th>Category</th>
            </tr>
        </thead>
        <tbody>
            {{#each transactions}}
                {{> transaction}}
            {{/each}}
        </tbody>
    </table>

    <section class="ui segment">
        {{> upload}}
        <a href="#" class="ui button clearall">Clear all</a>
    </section>
</template>

<template name="yearLinks">
    <div class="selectors">
        {{#each years}}
            <a class="ui button" href="{{pathFor 'transactionsByYear' year=year}}">{{year}}</a>
        {{/each}}
    </div>
</template>

<template name="monthLinks">
    <div class="selectors">
        {{#each months}}
            <a class="ui button" href="{{pathFor 'transactionsByMonth' year=year month=.}}">{{shortMonthName .}}</a>
        {{/each}}
    </div>
</template>

<template name="transaction">
    <tr>
        <td>{{dateFormat date}}</td>
        <td class="right aligned {{amountClass}}">{{currency amount}}</td>
        <td>{{description}}</td>
        <td>{{>categorySelect}}</td>
    </tr>
</template>

<template name="categorySelect">
    <div class="ui form">
        <div class="field">
            <select name="category" class="category">
                <option value="">-</option>
                {{#each options}}
                    {{> categorySelectOption}}
                {{/each}}
            </select>
        </div> 
    </div>
</template>

<template name="categorySelectOption">
    {{#if isSelected}}
    <option value="{{_id}}" selected="selected">{{name}}</option>
    {{else}}
    <option value="{{_id}}">{{name}}</option>
    {{/if}}
</template>

<template name="filteredTransactions">
        <table class="ui unstackable striped celled table">
        <thead>
            <tr>
                <th>Date</th>
                <th class="right aligned">Amount</th>
                <th>Description</th>
                <th>Category</th>
            </tr>
        </thead>
        <tbody>
            {{#each transactions}}
                {{> transaction}}
            {{/each}}
        </tbody>
    </table>
</template>
