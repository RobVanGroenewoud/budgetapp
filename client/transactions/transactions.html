<template name="transactions">
    <section class="ui segment">
        {{> upload}}
    </section>

    <div class="ui small statistics">
        <div class="statistic">
            <div class="value">{{nrOfTransactions}}</div>
            <div class="label">Transactions</div>
        </div>
        <div class="statistic">
            <div class="value">{{nrOfUncategorizedTransactions}}</div>
            <div class="label">Uncategorized</div>
        </div>
    </div>

    <a href="#" class="ui button clearall">Clear all</a>

    {{> filters}}

    <table class="ui unstackable striped celled table">
        <thead>
            <tr>
                <th>Date</th>
                <th class="right aligned">Amount</th>
                <th>Description</th>
                <th>Category</th>
            </tr>
        </thead>
        <tbody>
            {{#each transactions}}
                {{> transaction}}
            {{/each}}
        </tbody>
    </table>
</template>

<template name="filters">
    
    <div class="ui secondary menu">
    {{#each years}}
        <a href="{{pathFor 'transactions'}}/{{this}}" class="item">{{this}}</a>
    {{/each}}
    </div>

    {{#if selectedYear}}
    <div class="ui fluid twelve item secondary menu months">
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/01" class="item" data-month="01">Jan</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/02" class="item" data-month="02">Feb</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/03" class="item" data-month="03">Mar</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/04" class="item" data-month="04">Apr</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/05" class="item" data-month="05">May</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/06" class="item" data-month="06">Jun</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/07" class="item" data-month="07">Jul</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/08" class="item" data-month="08">Aug</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/09" class="item" data-month="09">Sep</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/10" class="item" data-month="10">Oct</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/11" class="item" data-month="11">Nov</a>
        <a href="{{pathFor 'transactions'}}/{{selectedYear}}/12" class="item" data-month="12">Dec</a>
    </div>
    {{/if}}
</template>

<template name="transaction">
    <tr>
        <td>{{dateFormat date}}</td>
        <td class="right aligned {{amountClass}}">{{currency amount}}</td>
        <td>{{description}}</td>
        <td>{{>categorySelect}}</td>
    </tr>
</template>

<template name="categorySelect">
    <div class="ui form">
        <div class="field">
            <select name="category" class="category">
                <option value="">-</option>
                {{#each options}}
                    {{> categorySelectOption}}
                {{/each}}
            </select>
        </div> 
    </div>
</template>

<template name="categorySelectOption">
    {{#if isSelected}}
    <option value="{{_id}}" selected="selected">{{name}}</option>
    {{else}}
    <option value="{{_id}}">{{name}}</option>
    {{/if}}
</template>
